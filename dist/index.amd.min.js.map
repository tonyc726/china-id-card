{"version":3,"file":"index.amd.min.js","sources":["../src/index.js"],"sourcesContent":["/**\n * 中华人民共和国国家标准 - 公民身份号码\n * @see https://zh.wikisource.org/wiki/GB_11643-1999_%E5%85%AC%E6%B0%91%E8%BA%AB%E4%BB%BD%E5%8F%B7%E7%A0%81\n */\n\n// 检验码结果对照表\nconst CHECK_CODE_MAP = ['1', '0', 'X', '9', '8', '7', '6', '5', '4', '3', '2'];\n\n// 身份号码中各个位置上的加权因子W(i)数值\nconst WEIGHTING_MAP = [7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2, 1];\n\n/**\n * 检验身份证基本格式，15位数字、18位数字、17位数字末尾是字母X\n *\n * @param {String | Number} IDCard - 待检验的身份证号\n * @return {Boolean} - 返回检验结果\n */\nconst checkBaseFormat = (IDCard = '') => (\n  (/(^\\d{15}$)|(^\\d{17}(\\d|X)$)/i).test(IDCard)\n);\n\n/**\n * 补全15位身份号码的年份，用于计算验证码\n *\n * @param {String | Number} IDCard - 待补全年份格式的15位身份证号码\n * @param {String | Number} [preYear = 19] - 年份前2位，默认为19\n */\nconst makeYearToYYYY = (IDCard = '', preYear = 19) => (\n  (/^\\d{15}$/).test(IDCard) ?\n    `${IDCard.substr(0, 6)}${preYear}${IDCard.substr(6, IDCard.length - 6)}` :\n    null\n);\n\n/**\n * 检验身份证前2位省级地址码是否正确\n * @see http://www.stats.gov.cn/tjsj/tjbz/xzqhdm/201703/t20170310_1471429.html\n *\n * @param {String | Number} IDCard - 待检验的身份证号\n * @return {Boolean} - 返回检验结果\n */\nconst checkProvince = (IDCard = '') => (\n  IDCard && (/^(11|12|13|14|15|21|22|23|31|32|33|34|35|36|37|41|42|43|44|45|46|50|51|52|53|54|61|62|63|64|65|71|81|82)/).test(IDCard)\n);\n\n/**\n * 检验身份证的生日信息是否正确，依据为年龄\n *\n * @param {String | Number} IDCard - 待检验的身份证号\n * @return {Boolean} - 返回检验结果\n */\nconst checkBirthday = (IDCard = '') => {\n  const birthdayMatch = IDCard.match(/^(\\d{6})(\\d{4})(\\d{2})(\\d{2})(\\d{3})([0-9]|X)$/);\n  if (birthdayMatch === null) {\n    return false;\n  }\n  // 年龄\n  const diffYear = (new Date()).getFullYear() - (new Date(`${birthdayMatch[2]}/${birthdayMatch[3]}/${birthdayMatch[4]}`)).getFullYear();\n  // 年龄在0-130之间，目前中国没有超过130岁的\n  return diffYear >= 0 && diffYear <= 130;\n};\n\n/**\n * 转换15位身份号码为18位身份证号码\n *\n * @param {String | Number} IDCard - 待转换的15位身份证号码\n * @param {String | Number} preYear - 年份前2位\n * @return {String} - 18位身份证号码\n */\nexport const tranformEighteen = (IDCard = '', preYear) => {\n  const IDCardMasterCode = makeYearToYYYY(IDCard, preYear);\n\n  return IDCardMasterCode === null ?\n    null :\n    `${IDCardMasterCode}${getCheckCode(IDCardMasterCode)}`;\n};\n\n/**\n * 获取身份证的末位检验码\n *\n * @param {String | Number} IDCard - 待检验的身份证号\n * @return {Number} - 如果身份证符合条件，则返回检验码\n */\nexport const getCheckCode = (IDCard = '') => {\n  const IDCardMasterCodeMatch = (/^\\d{15}$/).test(IDCard) ?\n    makeYearToYYYY(IDCard).match(/(^\\d{17})/) :\n    IDCard.match(/(^\\d{17})/);\n  if (\n    IDCardMasterCodeMatch === null\n  ) {\n    return null;\n  }\n  const IDCardMasterCode = IDCardMasterCodeMatch[1];\n  const IDCardMasterCodeWithWeightingReduce = IDCardMasterCode.split('').reduce(\n    (sum, a, i) => (sum + (a * WEIGHTING_MAP[i])),\n    0\n  );\n  return CHECK_CODE_MAP[IDCardMasterCodeWithWeightingReduce % 11];\n};\n\n/**\n * 身份证号码实例\n */\nclass IDCard {\n  constructor(id) {\n    if (!checkBaseFormat(id)) {\n      console.error('id card format is error!');\n      return false;\n    }\n\n    this.id = (id.length === 15) ? tranformEighteen(id) : id;\n    this.isVerified = (\n      checkProvince(id) &&\n      checkBirthday(this.id) &&\n      getCheckCode(this.id) === this.id.substr(17, 1)\n    );\n  }\n\n  getMasterCode() {\n    return this.isVerified ? this.id.substr(0, 17).toString() : null;\n  }\n\n  getCheckCode() {\n    return this.isVerified ? this.id.substr(17, 1).toString() : null;\n  }\n}\n\nexport default (IDCardNumber) => (\n  new IDCard(IDCardNumber)\n);\n"],"names":["CHECK_CODE_MAP","WEIGHTING_MAP","checkBaseFormat","IDCard","test","makeYearToYYYY","preYear","substr","length","checkProvince","checkBirthday","birthdayMatch","match","diffYear","Date","getFullYear","tranformEighteen","IDCardMasterCode","getCheckCode","IDCardMasterCodeMatch","IDCardMasterCodeWithWeightingReduce","split","reduce","sum","a","i","id","error","isVerified","this","toString","IDCardNumber"],"mappings":";+xCAMMA,GAAkB,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,KAGpEC,GAAiB,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,EAAG,GAAI,EAAG,EAAG,EAAG,EAAG,GAQtEC,EAAkB,eAACC,yDAAS,wCACCC,KAAKD,IASlCE,EAAiB,eAACF,yDAAS,GAAIG,yDAAU,oBAChCF,KAAKD,MACbA,EAAOI,OAAO,EAAG,GAAKD,EAAUH,EAAOI,OAAO,EAAGJ,EAAOK,OAAS,GACpE,MAUEC,EAAgB,eAACN,yDAAS,UAC9BA,GAAW,2GAA4GC,KAAKD,IASxHO,EAAgB,eACdC,0DADwB,IACDC,MAAM,qDACb,OAAlBD,SACK,MAGHE,GAAY,IAAIC,MAAQC,cAAiB,IAAID,KAAQH,EAAc,OAAMA,EAAc,OAAMA,EAAc,IAAOI,qBAEjHF,GAAY,GAAKA,GAAY,KAUzBG,EAAmB,eAACb,yDAAS,GAAIG,eACtCW,EAAmBZ,EAAeF,EAAQG,UAEpB,OAArBW,EACL,QACGA,EAAmBC,EAAaD,IAS1BC,EAAe,eAACf,yDAAS,GAC9BgB,EAAyB,WAAYf,KAAKD,GAC9CE,EAAeF,GAAQS,MAAM,aAC7BT,EAAOS,MAAM,gBAEa,OAA1BO,SAEO,SAGHC,EADmBD,EAAsB,GACcE,MAAM,IAAIC,OACrE,SAACC,EAAKC,EAAGC,UAAOF,EAAOC,EAAIvB,EAAcwB,IACzC,UAEKzB,EAAeoB,EAAsC,KAMxDjB,wBACQuB,iBACLxB,EAAgBwB,kBACXC,MAAM,6BACP,OAGJD,GAAoB,KAAdA,EAAGlB,OAAiBQ,EAAiBU,GAAMA,OACjDE,WACHnB,EAAciB,IACdhB,EAAcmB,KAAKH,KACnBR,EAAaW,KAAKH,MAAQG,KAAKH,GAAGnB,OAAO,GAAI,4DAKxCsB,KAAKD,WAAaC,KAAKH,GAAGnB,OAAO,EAAG,IAAIuB,WAAa,mDAIrDD,KAAKD,WAAaC,KAAKH,GAAGnB,OAAO,GAAI,GAAGuB,WAAa,uEAIhDC,UACd,IAAI5B,EAAO4B"}